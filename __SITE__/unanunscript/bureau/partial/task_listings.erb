<%

  #
  # Partiel pour l'affichage de n'importe quelle tache, donc servant pour
  # les onglets, taches, pages, quiz et forum.
  # On définit le type de tache en renseignant la constante TASK_TYPE
  # dans la vue appelant ce partiel.
  #

  # Requérir le module qui contient de nombreuses méthodes de
  # construction ainsi que des méthodes de gestion des tâches (comme
  # par exemple les méthodes qui permettent de démarrer les tâches
  # ou de les terminer)
  Unan.require_module 'taches'

  # Une opération a peut-être été demandée
  # Elle est contenue dans les paramètres, dans op pour l'opération et dans
  # wid pour l'identifiant du travail. Noter que seul l'auteur ou un administrateur
  # peuvent opérer.
# Les méthodes ci-dessous sont définies dans le fichier :
# ./__SITE__/unanunscript/_lib/_not_required/module/taches/work_class.rb
# ('gf' pour l'ouvrir)
  case param(:op)
  when 'start_work' then Unan::Work.start(user, param(:wid))
  when 'done_work'  then Unan::Work.done(user, param(:wid))
  end
  
%>

<% 
=begin

  Les méthodes ci-dessous sont définies dans le fichier :
  ./__SITE__/unanunscript/_lib/_not_required/module/taches/listes.rb
  (se placer sur le path et taper 'gf' pour l'ouvrir directement)  

  Noter que pour gagner une ligne, ci-dessous, on pourrait renvoyer la
  liste des taches à démarrer avec la méthode define_all_list_taches. Mais
  ici, on fait comme ça pour la clarté.

=end
%>
<% define_all_list_taches(user, TASK_TYPE) %>
<%= list_taches_to_start  %>
<%= list_taches_courantes %>
<%= list_last_taches_done %>
